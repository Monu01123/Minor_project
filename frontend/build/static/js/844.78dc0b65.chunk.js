"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[844],{3515:(e,t,o)=>{o.r(t),o.d(t,{default:()=>v});var n=o(5043),c=o(9722),s=o(3216),r=o(1043),a=o.n(r),i=o(6820),l=o(9304);const d=o.p+"static/media/no-content.3490095d532c65621bbd.png";var u=o(7762);const h=o.p+"static/media/Certificate1.1b554c66b2ebf4b2bde6.png";var p=o(579);const v=()=>{var e,t;const{courseId:o}=(0,s.g)(),[r,v]=(0,n.useState)([]),[g,f]=(0,n.useState)(null),[m,x]=(0,n.useState)(new Set),[j,w]=(0,n.useState)(!0),[k,S]=(0,n.useState)(!1),[_,b]=(0,n.useState)(null),[y]=(0,i.A)(),[C,A]=(0,n.useState)(!1),N=(0,n.useRef)(null),E=null===(e=(0,s.zy)().state)||void 0===e?void 0:e.courseName;(0,n.useEffect)((()=>{null!==y&&void 0!==y&&y.user&&((async()=>{var e;if(null!==y&&void 0!==y&&null!==(e=y.user)&&void 0!==e&&e.user_id)try{const e=y.token,t=await c.A.get("http://localhost:8080/api/video/track/".concat(y.user.user_id,"/").concat(o),{headers:{Authorization:"Bearer ".concat(e)}});if(t.data){const e=new Set(t.data.map((e=>e.content_id)));console.log("Watched Content IDs:",e),x(e)}}catch(t){console.error("Error fetching watched videos:",t),b("Error fetching watched videos")}})(),(async()=>{try{var e;const t=null===y||void 0===y?void 0:y.token,n=await c.A.get("http://localhost:8080/api/content/enrolled/".concat(o),{headers:{Authorization:"Bearer ".concat(t)}});console.log("Course Content Response:",n.data),v(n.data),f((null===(e=n.data[0])||void 0===e?void 0:e.content_url)||null)}catch(t){console.error("Error fetching course content:",t),b("Error fetching course content")}finally{w(!1)}})())}),[o,y]),(0,n.useEffect)((()=>{(async()=>{var e;if(null!==y&&void 0!==y&&null!==(e=y.user)&&void 0!==e&&e.user_id)try{const e=await c.A.post("http://localhost:8080/api/check-completion",{userId:y.user.user_id,courseId:o});console.log("Course completion response:",e.data),S(e.data.completed)}catch(_){console.error("Error checking course completion:",_),b("Error checking course completion")}})()}),[y,o]);const z=null===y||void 0===y||null===(t=y.user)||void 0===t?void 0:t.full_name,I=E,F=async e=>{try{const t=y.token;await c.A.post("http://localhost:8080/api/video/track",{userId:y.user.user_id,courseId:o,contentId:e},{headers:{Authorization:"Bearer ".concat(t)}}),console.log("Video marked as watched"),x((t=>new Set(t).add(e)))}catch(_){console.error("Error marking video as watched:",_),b("Error updating video watch status")}};return j?(0,p.jsx)("p",{children:"Loading..."}):_?(0,p.jsx)("p",{children:_}):0===r.length?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(l.A,{}),(0,p.jsx)("div",{className:"no-content-student",children:(0,p.jsxs)("div",{children:[(0,p.jsx)("img",{src:d,alt:"No content available"}),(0,p.jsx)("p",{children:"No content available for this course."})]})})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(l.A,{}),(0,p.jsxs)("div",{className:"course-content-page",children:[(0,p.jsx)("div",{className:"video-player",children:g?(0,p.jsx)(a(),{ref:N,url:g,controls:!0,width:"100%",height:"auto",onProgress:e=>{let{played:t}=e;if(t>=.5&&!C){A(!0);const e=r.find((e=>e.content_url===g));e&&F(e.content_id)}},config:{file:{attributes:{controlsList:"nodownload"}}}}):(0,p.jsx)("p",{children:"No video selected"})}),(0,p.jsxs)("div",{className:"content-list",children:[(0,p.jsx)("h3",{children:E?"".concat(E):"Course Content"}),k&&(0,p.jsx)("button",{onClick:()=>(()=>{const e=new u.Ay;e.addImage(h,"PNG",0,0,e.internal.pageSize.getWidth(),e.internal.pageSize.getHeight()),e.setFontSize(36),e.setFont("helvetica"),e.text(z,105,160,{align:"center"}),e.setFontSize(15),e.text("instructor",122,178.5),e.setFontSize(20),e.text(I,105,195,{align:"center"}),e.save("".concat(z,"-").concat(I,".pdf"))})(),className:"download-certificate",children:"Get Certificate"}),(0,p.jsx)("ul",{children:r.map((e=>(0,p.jsx)("li",{className:e.content_url===g?"active selected-list-items":"selected-list-items",onClick:()=>{e.content_url?f(e.content_url):alert("You need to enroll to access this content.")},style:{cursor:"pointer",borderBottom:m.has(e.content_id)?"4px solid red":"none"},children:e.title},e.content_id)))})]})]})]})}}}]);
//# sourceMappingURL=844.78dc0b65.chunk.js.map